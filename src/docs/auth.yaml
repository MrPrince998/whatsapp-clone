paths:
  /auth/generate-otp:
    post:
      tags:
        - Authentication
      summary: Generate OTP for phone verification
      description: Send an OTP to the provided email/phone for verification
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                  description: "User's email address"
            examples:
              valid_request:
                summary: Valid OTP generation request
                value:
                  email: "john.doe@example.com"
      responses:
        "200":
          description: OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OTP sent successfully"
                  expiresAt:
                    type: string
                    format: date-time
                    example: "2025-12-04T15:30:00Z"
        "400":
          description: Invalid email format
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                message: "Invalid email format"
                status: 400
        "429":
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                message: "Too many OTP requests. Please try again later."
                status: 429

  /auth/verify-otp:
    post:
      tags:
        - Authentication
      summary: Verify OTP and get JWT token
      description: Verify the OTP and receive authentication token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - otp
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                otp:
                  type: string
                  pattern: "^[0-9]{6}$"
                  example: "123456"
                  description: "6-digit OTP code"
            examples:
              valid_verification:
                summary: Valid OTP verification
                value:
                  email: "john.doe@example.com"
                  otp: "123456"
      responses:
        "200":
          description: OTP verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Login successful"
                  token:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  user:
                    $ref: "#/components/schemas/User"
        "400":
          description: Invalid OTP or email
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                invalid_otp:
                  summary: Invalid OTP
                  value:
                    message: "Invalid OTP"
                    status: 400
                expired_otp:
                  summary: Expired OTP
                  value:
                    message: "OTP has expired"
                    status: 400
        "429":
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                message: "Too many verification attempts. Please try again later."
                status: 429

  /auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user profile
      description: Retrieve the authenticated user's profile information
      security:
        - bearerAuth: []
      responses:
        "200":
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized - Invalid or missing token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                message: "Access denied. No token provided."
                status: 401

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh JWT token
      description: Get a new JWT token using the current token
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  expiresAt:
                    type: string
                    format: date-time
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
